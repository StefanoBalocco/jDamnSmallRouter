"use strict";class t{static t;static i(){return void 0===t.t&&(t.t=new t),t.t}static h(t,e){const i=t=>{let e=[t];return t.includes(":AZ09")&&e.push(...i(t.replace(/:AZ09/,":AZ")),...i(t.replace(/:AZ09/,":09"))),e},s=new Set(i(t));return[...i(e)].some((t=>s.has(t)))}o=new RegExp(/\/(:\w+)\[(?:09|AZ)]\/(?:.+\/)?(\1)(?:\[(?:09|AZ)]|\/|$)/g);u=new RegExp(/(?<=^|\/):(\w+)(?:\[(09|AZ)])?(?=\/|$)/g);l=[];p;A;Z=!1;_=[];R=window;k=this.R.location;constructor(){this.R.addEventListener("hashchange",this.CheckHash.bind(this))}RouteSpecialAdd(t,e){let i=!1;switch(t){case 403:this.p=e,i=!0;break;case 404:this.A=e,i=!0;break;default:throw new RangeError}return i}RouteAdd(e,i,s,n){let a=!1;if(e.match(this.o))throw new SyntaxError("Duplicate path id");{let r=0,h=new RegExp("^"+e.replace(this.u,(function(t,e,i){let s="(?<"+e+">[";switch(i){case"09":s+="\\d";break;case"AZ":s+="a-zA-Z";break;default:s+="a-zA-Z\\d"}return s+="]+)",s})).replace(/\//g,"\\/")+"$");const o=e.replace(this.u,((t,e,i)=>`:${i??"AZ09"}`)),c=e.split("/"),u=c.length;for(let t=0;t<u;t++)c[t].startsWith(":")||(r+=2**(u-t-1));this.l.find((e=>t.h(o,e.path)))||(this.l.push({path:o,match:h,weight:r,routeFunction:i,available:s,routeFunction403:n}),this.l.sort(((t,e)=>t.weight>e.weight?-1:e.weight>t.weight?1:0)),a=!0)}return a}RouteDel(e){let i=!1;if(e.match(this.o))throw new SyntaxError("Duplicate path id");{const s=e.replace(this.u,((t,e,i)=>`:${i??"AZ09"}`)),n=this.l.findIndex((e=>t.h(s,e.path)));-1<n&&(this.l.splice(n,1),i=!0)}return i}Trigger(t){"#"+t!=this.k.hash&&(this.k.hash="#"+t)}async Route(t){let e=!0;if(this._.push(t),this.Z)e=!1;else{for(this.Z=!0;t=this._.shift();){let e;const i=this.l.find((i=>!!(e=i.match.exec(t))));if(i&&e){let s=i.path,n=!i.available||"function"==typeof i.available&&await i.available(s,t,e.groups??{})?i.routeFunction:i.routeFunction403??this.p;"function"!=typeof n&&this.A&&(n=this.A),"function"==typeof n&&await n(s,t,e?.groups??{})}}this.Z=!1}return e}async CheckHash(){const t=this.k.hash.substring(1);""!=t&&(this.Z?this._.push(t):await this.Route(t))}}export default t.i;