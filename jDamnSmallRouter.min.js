"use strict";class t{static t;static i(){return void 0===t.t&&(t.t=new t),t.t}static h(t,e){const i=t=>{let e=[t];return t.includes(":AZ09")&&e.push(...i(t.replace(/:AZ09/,":AZ")),...i(t.replace(/:AZ09/,":09"))),e},s=new Set(i(t));return[...i(e)].some((t=>s.has(t)))}o=new RegExp(/\/(:\w+)\[(?:09|AZ)]\/(?:.+\/)?(\1)(?:\[(?:09|AZ)]|\/|$)/g);u=new RegExp(/(?<=^|\/):(\w+)(?:\[(09|AZ)])?(?=\/|$)/g);l=[];p;A;_;Z=!1;R=[];k=window;S=this.k.location;constructor(){this.k.addEventListener("hashchange",this.CheckHash.bind(this))}D(){return this.S.hash.substring(1)}RouteSpecialAdd(t,e){let i=!1;switch(t){case 403:this.p=e,i=!0;break;case 404:this.A=e,i=!0;break;case 500:this._=e,i=!0;break;default:throw new RangeError}return i}RouteAdd(e,i,s,n){let r=!1;if(e.match(this.o))throw new SyntaxError("Duplicate path id");{let a=0,h=new RegExp("^"+e.replace(this.u,(function(t,e,i){let s="(?<"+e+">[";switch(i){case"09":s+="\\d";break;case"AZ":s+="a-zA-Z";break;default:s+="a-zA-Z\\d"}return s+="]+)",s})).replace(/\//g,"\\/")+"$");const o=e.replace(this.u,((t,e,i)=>`:${i??"AZ09"}`)),c=e.split("/"),u=c.length;for(let t=0;t<u;t++)c[t].startsWith(":")||(a+=2**(u-t-1));this.l.find((e=>t.h(o,e.path)))||(this.l.push({path:o,match:h,weight:a,routeFunction:i,available:s,routeFunction403:n}),this.l.sort(((t,e)=>t.weight>e.weight?-1:e.weight>t.weight?1:0)),r=!0)}return r}RouteDel(e){let i=!1;if(e.match(this.o))throw new SyntaxError("Duplicate path id");{const s=e.replace(this.u,((t,e,i)=>`:${i??"AZ09"}`)),n=this.l.findIndex((e=>t.h(s,e.path)));-1<n&&(this.l.splice(n,1),i=!0)}return i}async Trigger(t){return void 0!==t&&t!=this.D()&&(this.S.hash="#"+t),await this.CheckHash()}async Route(t){let e=!0;if(this.R.push(t),this.Z)e=!1;else{for(this.Z=!0;t=this.R.shift();){let e,i;const s=this.l.filter((e=>!!e.match.exec(t))).sort(((t,e)=>e.weight-t.weight));let n={};if(0<s.length){const r=s[0];n=r.match.exec(t).groups??{},e=r.path,i=!r.available||"function"==typeof r.available&&await r.available(e,t,n)?r.routeFunction:r.routeFunction403??this.p,"function"!=typeof i&&(i=this._)}else i=this.A;"function"==typeof i&&await i(e,t,n)}this.Z=!1}return e}async CheckHash(){const t=this.D();return!!t&&await this.Route(t)}}export default t.i;